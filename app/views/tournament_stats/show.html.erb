<head>
	<!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {packages: ['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawBasic);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawBasic() {

        // Create the data table.
        var data = new google.visualization.DataTable();
      	data.addColumn('date', 'Date');
      	data.addColumn('number', 'Players');
      	data.addColumn('number', 'Spectators');
      	data.addColumn('number', 'Dinner guests');

        // alert($('#all-data').val());
        var check = <%= @all_data.to_json.html_safe %>
        for (i = 0; i < check.length; i++)
        {
        	var parts = check[i][0].split('-');
        	check[i][0] = new Date(parts[0], parts[1]-1, parts[2]);
        }

        data.addRows(check);

        // Set chart options
        var options = {
        hAxis: {
	          title: 'Dates'
	        },
	        vAxis: {
	          title: 'Tickets sold'
	        },
	        series: {
	          1: {curveType: 'function'}
	        }
	    };

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
      	chart.draw(data, options);
      }
    </script>
</head>

<h1><%=@tournament_name%> stats</h1>
	
	Checked in: <%= @num_checked_in %>
	<BR/> <BR/>
	Number of guests (of users) at this event: <%= @num_guests %>
	<BR/> <BR/>
	Number of sponsors: <%= @num_sponsors %>
	<BR/> <BR/>
	Current revenue from selling sponsorships: $<%= @revenue_sponsors %>
	<BR/> <BR/>
	Player tickets sold: <%= @player_tickets_sold %>
	<BR/> <BR/>
	Foursomes sold: <%= @tournament.num_foursomes %>
	<BR/> <BR/>
	Spectator tickets sold: <%= @spectator_tickets_sold %>
	<BR/> <BR/>
	Dinner tickets sold: <%= @dinner_tickets_sold %>
	<BR/> <BR/>
	Player tickets sold: <%= @player_tickets_sold %>
	<BR/> <BR/>
	Current revenue from selling player tickets: $<%= @revenue_players %>
	<BR/> <BR/>
	Current revenue from selling foursome tickets: $<%= @revenue_foursomes %>
	<BR/> <BR/>
	Current revenue from selling spectator tickets: $<%= @revenue_spectators %>
	<BR/> <BR/>
	Current revenue from selling dinner tickets: $<%= @revenue_dinner %>
	<BR/> <BR/>
	Potential revenue from selling player tickets: $<%= @potential_revenue_players %>
	<BR/> <BR/>
	Potential revenue from selling spectator tickets: $<%= @potential_revenue_spectators %>
	<BR/> <BR/>
	Potential revenue from selling dinner tickets: $<%= @potential_revenue_dinner %>
	<BR/> <BR/>
	Total potential revenue: $<%= @potential_revenue %>
	<BR/> <BR/>
	Total current revenue: $<%= @revenue %>
	<BR/> <BR/>
	Current cost ($2.50 per player signed up): $<%= @cost %>
	<BR/> <BR/>
	Net: $<%= @net %>
  <br/>
  <br/>

  <body>
    <!--Div that will hold the pie chart-->
    <div id="chart_div"></div>
</body>

<%= link_to "Download PDF", {:controller => "tournament_stats", :action => "download_pdf"} %>
